<!doctype html>
<html>
  <head>
    <title>Ericometro</title>
    
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
    <script src="/socket.io/socket.io.js"></script>
    <script src="https://code.jquery.com/jquery-1.11.1.js"></script>
    
    <link rel="stylesheet" type="text/css" href="css/style.css" />
    <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
    
  </head>


  <body>
    <div class="container">

      <h1>Ericometro</h1>
      
      <button type="button" class="btn btn-primary">
        logout
      </button>      

      <div id="bar" class="col-md-12"><div class="bar-inn"></div></div>
     
      <div class="col-md-12 buttons-container">
        <div class="col-md-6 nopadding button_inn"><button id="buttonUp">Subir</button></div>
        <div class="col-md-6 nopadding button_inn"><button id="buttonDown">Bajar</button></div>
      </div>

      <div class="container-messages col-md-12">

        <ul id="messages"></ul>

        <form id="sendMessageForm" action="">
          <input id="m" autocomplete="off" /><button id="sendButtonFormChat">Send</button>
        </form>

      </div>

    </div>

  </body>


  <script>

    $(function () {  
      var socket = io();
      var num = 5;

      $('#sendMessageForm').submit(function(){
        socket.emit('chat message', $('#m').val());
        $('#m').val('');
        return false;
      });

      $('#buttonUp').click(function(){
        socket.emit('bar up', num);
      });  
      $('#buttonDown').click(function(){
        socket.emit('bar down', num);
      });      

      socket.on('bar up', function(msg){
        $('.bar-inn').css('width', msg + '%');
        colorBar(msg);
      });

      socket.on('bar down', function(msg){
        $('.bar-inn').css('width', msg + '%');
        colorBar(msg);
      });

      socket.on('chat message', function(msg){
        $('#messages').append($('<li>').text(msg));
      });

      socket.on('user connect', function(msg){
        $('#messages').append($('<li>').text(msg));
      });

      socket.on('user disconnect', function(msg){
        $('#messages').append($('<li>').text(msg));
      });

      function colorBar(msg){
        if(msg <= 30){
          $('.bar-inn').css('background-color','green');  
        }else if(msg > 30 && msg <= 70){
          $('.bar-inn').css('background-color','yellow');
        }else{
          $('.bar-inn').css('background-color','red');
        }
      }
    });
  </script>
    

</html>